WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.codebarrel.addons.automation:manual-trigger-client-resources', location = '/page/viewissue/manual-triggers-support.js' */
define("codebarrel/manual-triggers-support",["jquery","jira/flag","jira/util/events","jira/util/events/types","jira/issue","jira/util/browser",],function($,flag,Events,EventTypes,Issue,Browser){const isIssuePage=function(){return JIRA&&JIRA.Issue&&JIRA.Issue.getStalker&&JIRA.Issue.getStalker().length>0};const showSpinner=function(){const spinContainer=$('<div class="toolbar-group" style="width:16px;height:16px;padding-top: 4px;"/>');const issueOperations=$("#stalker .ops-menus .toolbar-split-left");if(issueOperations.length>0){issueOperations.append(spinContainer);spinContainer.spin()}return spinContainer};const executeManualTrigger=function(url){return $.ajax({url:url,type:"POST",contentType:"application/json",dataType:"json",success:function(){flag.showSuccessMsg("Automation","Automation rule was successfully executed.")},error:function(){flag.showErrorMsg("Automation","Error executing automation rule. Please reload the issue and try again.")}})};return{init:function(){$(document).on("click",".cb-manual-rule-trigger",function(e){e.preventDefault();const spinner=showSpinner();const url=$(this).attr("href");const urlWithoutReturnUrl=url.split("&returnUrl=")[0];executeManualTrigger(urlWithoutReturnUrl).always(function(){spinner.spinStop()}).done(function(){if(isIssuePage()){Events.trigger(EventTypes.REFRESH_ISSUE_PAGE,[Issue.getIssueId()])}else{Browser.reloadViaWindowLocation()}})})}}});
}catch(e){WRMCB(e)};